# ~/rustdesk-server-backend/Caddyfile
desk.captainkirk.dev {
    # Caddy will automatically get SSL certificates for desk.captainkirk.dev

    # Route traffic to HBBS (Signaling Server)
    # This assumes RustDesk clients can connect to HBBS over this HTTP/S port
    # and Caddy forwards it. For the custom RustDesk protocol, this is often tricky.
    reverse_proxy hbbs:21115 {
        # Optional: Add headers if RustDesk expects them, or if specific client setup.
        # header_up Host {http.request.host}
        # header_up X-Forwarded-For {http.request.remote}
    }

    # You might need separate blocks or rules for other RustDesk ports (HBBR: 21116, 21117, etc.)
    # if they need to be routed via this domain.
    # If clients connect to these directly via Render's IP, then Caddy doesn't need to proxy them.

    # Fallback to general relay if specific paths aren't used or for direct client connections
    # This would try to send all other traffic to HBBR
    reverse_proxy / {
        to hbbr:21116
    }
}
